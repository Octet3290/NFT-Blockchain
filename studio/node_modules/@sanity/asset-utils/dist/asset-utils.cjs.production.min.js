"use strict";function t(){return(t=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function i(t,e,s){return(i=n()?Reflect.construct.bind():function(t,e,n){var i=[null];i.push.apply(i,e);var s=new(Function.bind.apply(t,i));return n&&r(s,n.prototype),s}).apply(null,arguments)}function s(t){var n="function"==typeof Map?new Map:void 0;return(s=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,s)}function s(){return i(t,arguments,e(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),r(s,t)})(t)}Object.defineProperty(exports,"__esModule",{value:!0});var o=Object.freeze({left:0,top:0,bottom:0,right:0}),a=Object.freeze({x:.5,y:.5,height:1,width:1}),u=function(){return t({},o)},f=function(){return t({},a)},p=function(t){var e,n;function i(e,r){var n;return void 0===r&&(r="Failed to resolve asset ID from source"),(n=t.call(this,r)||this).unresolvable=!0,n.input=e,n}return n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,r(e,n),i}(s(Error));function l(t){return Boolean(t.unresolvable&&"input"in t)}function c(t){return function(){try{return t.apply(void 0,arguments)}catch(t){if(l(t))return;throw t}}}var d="https://cdn.sanity.io",h=/^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+\.[a-z0-9]+$/,x=/^file-([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-[a-z0-9]+$/,g=/^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})-\d+x\d+\.[a-z0-9]+$/,m=/^image-([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-\d+x\d+-[a-z0-9]+$/,y=/^(images|files)\/([a-z0-9]+)\/([a-z0-9][-\w]*)\//,v=/^(?:image-(?:[a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-\d+x\d+-[a-z0-9]+|file-(?:[a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+-[a-z0-9]+)$/,w={projectId:"a",dataset:"b"};function I(t){return S(t)&&"string"==typeof t._ref}function b(t){return S(t)&&"string"==typeof t._id}function A(t){return S(t)&&"string"==typeof t.path}function F(t){return S(t)&&"string"==typeof t.url}function j(t){return S(t)&&"sanity.fileAsset"===t._type}function O(t){return S(t)&&"sanity.imageAsset"===t._type}function _(t){return m.test(t)}function U(t){return x.test(t)}function P(t){var e=t;return S(e)&&e.asset&&"object"==typeof e.asset}function S(t){return null!==t&&!Array.isArray(t)&&"object"==typeof t}function z(t,e){var r=(null==e?void 0:e.projectId)||t.projectId,n=(null==e?void 0:e.dataset)||t.dataset;if(!r||!n)throw new Error("Project details (projectId and dataset) required to resolve path for image");var i="metadata"in t?t.metadata.dimensions:{width:t.width,height:t.height};return"images/"+r+"/"+n+"/"+t.assetId+"-"+i.width+"x"+i.height+"."+t.extension+N("originalFilename"in t?t.originalFilename:void 0,t.vanityFilename,e)}function E(t,e){return d+"/"+z(t,e)}function R(t,e){var r=(null==e?void 0:e.projectId)||t.projectId,n=(null==e?void 0:e.dataset)||t.dataset;if(!r||!n)throw new Error("Project details (projectId and dataset) required to resolve path for file");return"files/"+r+"/"+n+"/"+t.assetId+"."+t.extension+N("originalFilename"in t?t.originalFilename:void 0,t.vanityFilename,e)}function D(t,e){return d+"/"+R(t,e)}function G(t){return P(t)?G(t.asset):I(t)?void 0:"string"==typeof t?y.test($(t)||"")?L(t):void 0:A(t)?t.path:F(t)?L(t.url):void 0}function L(t){if(y.test(t))return t;if(!t.startsWith(d+"/"))throw new p('Failed to resolve path from URL "'+t+'"');var e=t.indexOf("?");return t.slice(d.length+1,-1===e?void 0:e)}var $=c(L);function T(t){var e=($(t)||t).replace(/^(images|files)\/[a-z0-9]+\/[a-z0-9][-\w]\/*/,"");if(!M(e))throw new p('Failed to resolve filename from URL "'+t+'"');return e}var Z=c(T);function M(t){return h.test(t)||g.test(t)}function N(t,e,r){var n=e||t;return!1!==(null==r?void 0:r.useVanityName)&&n?"/"+n:""}function V(t){if(m.test(t))return B(t);if(x.test(t))return W(t);throw new Error("Invalid image/file asset ID: "+t)}function W(t){if(!x.test(t))throw new Error("Malformed file asset ID '"+t+'\'. Expected an id like "file-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-pdf"');var e=t.split("-");return{type:"file",assetId:e[1],extension:e[2]}}function B(t){var e=t.split("-"),r=e[1],n=e[2],i=e[3],s=(n||"").split("x").map(Number),o=s[0],a=s[1];if(!(r&&n&&i&&o>0&&a>0))throw new Error("Malformed asset ID '"+t+'\'. Expected an id like "image-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-2000x3000-jpg".');return{type:"image",assetId:r,width:o,height:a,extension:i}}function C(t){var e=Z(t)||"";if(!M(e))throw new Error("Invalid image/file asset filename: "+t);try{return V((g.test(e)?"image":"file")+"-"+e.replace(/\.([a-z0-9+]+)$/i,"-$1"))}catch(e){throw new Error("Invalid image/file asset filename: "+t)}}function H(e){if(!e.startsWith(d))throw new Error("URL is not a valid Sanity asset URL: "+e);var r=e.slice(d.length).replace(/^\/+/,""),n=r.match(y)||[],i=n[0],s=n[2],o=n[3];if(!s||!o)throw new Error("URL is not a valid Sanity asset URL: "+e);var a=r.slice(i.length).split("/"),u=a[1];return t({},C(a[0]),{projectId:s,dataset:o,vanityFilename:u})}function k(t){try{return H(t).type}catch(t){return!1}}function q(t){var e=B(ot(t)),r=e.width,n=e.height;return{width:r,height:n,aspectRatio:r/n}}var J=c(q);function K(t){return xt(t)?rt(t,w).asset.extension:X(t,w).asset.extension}var Q=c(K);function X(t,e){var r=t;return{asset:tt(t,e||ct(t)),crop:r.crop||u(),hotspot:r.hotspot||f()}}var Y=c(X);function tt(e,r){var n=t({},r||lt(e),{useVanityName:!1}),i=ot(e),s=(e.asset||e).metadata||{},o=B(i),a=o.assetId,u=o.width,f=o.height,p=o.extension,l=u/f,c=t({},O(e)?e:{},{_id:i,_type:"sanity.imageAsset",assetId:a,extension:p,metadata:t({},s,{dimensions:{width:u,height:f,aspectRatio:l}}),url:"",path:""});return t({},c,{path:z(c,n),url:E(c,n)})}var et=c(tt);function rt(t,e){return{asset:it(t,e||ct(t))}}var nt=c(rt);function it(e,r){var n=t({},r||lt(e),{useVanityName:!1}),i=ot(e),s=e.asset||e,o=W(i),a=o.assetId,u=o.extension,f=t({},j(e)?e:{},{_id:i,_type:"sanity.fileAsset",assetId:a,extension:u,metadata:s.metadata||{},url:"",path:""});return t({},f,{path:R(f,n),url:D(f,n)})}var st=c(it);function ot(t){var e=P(t)?t.asset:t,r="";if("string"==typeof e?r=ut(e):I(e)?r=e._ref:b(e)?r=e._id:A(e)?r=pt(d+"/"+e.path):F(e)&&(r=pt(e.url)),!r||!v.test(r))throw new p(t);return r}var at=c(ot);function ut(t){if(v.test(t))return t;if(0===t.indexOf(d+"/images")||0===t.indexOf(d+"/files"))return pt(t);if(y.test(t))return pt(d+"/"+t);if(ht(t))return pt(d+"/files/a/b/"+t);if(dt(t))return pt(d+"/images/a/b/"+t);throw new p(t)}var ft=c(ut);function pt(t){var e=L(t).split("/"),r=e[3];return e[0].replace(/s$/,"")+"-"+r.replace(/\./g,"-")}function lt(t){var e=G(t);if(!e)throw new p(t,"Failed to resolve project ID and dataset from source");var r=e.match(y)||[],n=r[2],i=r[3];if(!n||!i)throw new p(t,"Failed to resolve project ID and dataset from source");return{projectId:n,dataset:i}}var ct=c(lt);function dt(t){return g.test(t)}function ht(t){return h.test(t)}function xt(t){var e=at(t);return!!e&&e.startsWith("file-")}exports.DEFAULT_CROP=o,exports.DEFAULT_HOTSPOT=a,exports.buildFilePath=R,exports.buildFileUrl=D,exports.buildImagePath=z,exports.buildImageUrl=E,exports.getAssetDocumentId=ot,exports.getAssetUrlType=k,exports.getDefaultCrop=u,exports.getDefaultHotspot=f,exports.getExtension=K,exports.getFile=rt,exports.getFileAsset=it,exports.getIdFromString=ut,exports.getImage=X,exports.getImageAsset=tt,exports.getImageDimensions=q,exports.getProject=lt,exports.getUrlFilename=T,exports.getUrlPath=L,exports.isAssetFilename=function(t){return dt(t)||ht(t)},exports.isAssetId=function(t){return _(t)||U(t)},exports.isAssetIdStub=b,exports.isAssetObjectStub=P,exports.isAssetPathStub=A,exports.isAssetUrlStub=F,exports.isDefaultCrop=function(t){return t.top===o.top&&t.bottom===o.bottom&&t.left===o.left&&t.right===o.right},exports.isDefaultHotspot=function(t){return t.x===a.x&&t.y===a.y&&t.width===a.width&&t.height===a.height},exports.isFileAssetFilename=ht,exports.isFileAssetId=U,exports.isFileSource=xt,exports.isImageAssetFilename=dt,exports.isImageAssetId=_,exports.isImageSource=function(t){var e=at(t);return!!e&&e.startsWith("image-")},exports.isObject=S,exports.isReference=I,exports.isSanityAssetUrl=function(t){return!1!==k(t)},exports.isSanityFileAsset=j,exports.isSanityFileUrl=function(t){return"file"===k(t)},exports.isSanityImageAsset=O,exports.isSanityImageUrl=function(t){return"image"===k(t)},exports.isValidFilename=M,exports.parseAssetFilename=C,exports.parseAssetId=V,exports.parseAssetUrl=H,exports.parseFileAssetId=W,exports.parseFileAssetUrl=function(t){var e=H(t);if("file"!==e.type)throw new Error("URL is not a valid Sanity file asset URL: "+t);return e},exports.parseImageAssetId=B,exports.parseImageAssetUrl=function(t){var e=H(t);if("image"!==e.type)throw new Error("URL is not a valid Sanity image asset URL: "+t);return e},exports.tryGetAssetDocumentId=at,exports.tryGetAssetPath=G,exports.tryGetExtension=Q,exports.tryGetFile=nt,exports.tryGetFileAsset=st,exports.tryGetIdFromString=ft,exports.tryGetImage=Y,exports.tryGetImageAsset=et,exports.tryGetImageDimensions=J,exports.tryGetProject=ct,exports.tryGetUrlFilename=Z,exports.tryGetUrlPath=$;
//# sourceMappingURL=asset-utils.cjs.production.min.js.map
