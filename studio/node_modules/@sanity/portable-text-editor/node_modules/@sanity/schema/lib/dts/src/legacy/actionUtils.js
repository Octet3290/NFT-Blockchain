import { generateHelpUrl } from '@sanity/generate-help-url';
import { difference } from 'lodash';
var ACTIONS_FLAG = '__experimental_actions';
var DEFAULT_ACTIONS = ['create', 'update', 'delete', 'publish'];
var VALID_ACTIONS = DEFAULT_ACTIONS;
// todo: enable this when officially deprecating experimental actions
var DEPRECATE_EXPERIMENTAL_ACTIONS = false;
var hasWarned = {};
var readActions = function (schemaType) {
    if (DEPRECATE_EXPERIMENTAL_ACTIONS && !(schemaType.name in hasWarned)) {
        console.warn("Heads up! Experimental actions is now deprecated and replaced by Document Actions. Read more about how to migrate on ".concat(generateHelpUrl('experimental-actions-replaced-by-document-actions'), "\".\n"));
        hasWarned[schemaType.name] = true;
    }
    return ACTIONS_FLAG in schemaType ? schemaType[ACTIONS_FLAG] : DEFAULT_ACTIONS;
};
var validateActions = function (typeName, actions) {
    if (!Array.isArray(actions)) {
        throw new Error("The value of <type>.".concat(ACTIONS_FLAG, " should be an array with any of the actions ").concat(VALID_ACTIONS.join(', ')));
    }
    var invalid = difference(actions, VALID_ACTIONS);
    if (invalid.length > 0) {
        throw new Error("Invalid action".concat(invalid.length > 1 ? 's' : '', " configured for schema type \"").concat(typeName, "\": ").concat(invalid.join(', '), ". Valid actions are: ").concat(VALID_ACTIONS.join(', ')));
    }
    return actions;
};
export var resolveEnabledActions = function (schemaType) {
    return validateActions(schemaType.name, readActions(schemaType));
};
export var isActionEnabled = function (schemaType, action) {
    return resolveEnabledActions(schemaType).includes(action);
};
//# sourceMappingURL=actionUtils.js.map